!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.rbush=t()}}(function(){return function t(i,n,e){function r(o,h){if(!n[o]){if(!i[o]){var s="function"==typeof require&&require;if(!h&&s)return s(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};i[o][0].call(c.exports,function(t){var n=i[o][1][t];return r(n?n:t)},c,c.exports,t,i,n,e)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,i,n){"use strict";function e(t,i){return this instanceof e?(this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this._nodesUuid={},i&&this._initFormat(i),void this.clear()):new e(t,i)}function r(t,i,n){if(!n)return i.indexOf(t);for(var e=0;e<i.length;e++)if(n(t,i[e]))return e;return-1}function a(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function o(t,i){return t.minX-i.minX}function h(t,i){return t.minY-i.minY}function s(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,i){return(Math.max(i.maxX,t.maxX)-Math.min(i.minX,t.minX))*(Math.max(i.maxY,t.maxY)-Math.min(i.minY,t.minY))}function f(t,i){var n=Math.max(t.minX,i.minX),e=Math.max(t.minY,i.minY),r=Math.min(t.maxX,i.maxX),a=Math.min(t.maxY,i.maxY);return Math.max(0,r-n)*Math.max(0,a-e)}function l(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function d(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function m(t,i,n,e,r){for(var a,o=[i,n];o.length;)n=o.pop(),i=o.pop(),n-i<=e||(a=i+Math.ceil((n-i)/e/2)*e,x(t,a,i,n,r),o.push(i,a,a,n))}i.exports=e;var x=t("quickselect"),p=t("uuid");e.prototype={all:function(t){return t=t||this.data,this._all(t,[])},getNode:function(t){return this._nodesUuid[t]},walk:function(t){var i=[],n=this.data,e=function(n){if(i.push(n),t(n,i),!n.children)return void i.pop(n);for(var r=0;r<n.children.length;r++)e(n.children[r]);i.pop(n)};e(n)},search:function(t){var i=this.data,n={parentNodes:{},leafNodes:[]},e=this.toBBox;if(!d(t,i))return n;for(var r,a,o,h,s=[];i;){for(r=0,a=i.children.length;r<a;r++)o=i.children[r],h=i.leaf?e(o):o,d(t,h)&&(n.parentNodes[i.height]=n.parentNodes[i.height]||{},n.parentNodes[i.height][i.id]=i,i.leaf?n.leafNodes.push(o):l(t,h)?this._all(o,n.leafNodes,n.parentNodes):s.push(o));i=s.pop()}return n},collides:function(t){var i=this.data,n=this.toBBox;if(!d(t,i))return!1;for(var e,r,a,o,h=[];i;){for(e=0,r=i.children.length;e<r;e++)if(a=i.children[e],o=i.leaf?n(a):a,d(t,o)){if(i.leaf||l(t,o))return!0;h.push(a)}i=h.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}var e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){var r=this.data;this.data=e,e=r}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=this._createNode([]),this},remove:function(t,i){if(!t)return this;for(var n,e,a,o,h=this.data,s=this.toBBox(t),u=[],c=[];h||u.length;){if(h||(h=u.pop(),e=u[u.length-1],n=c.pop(),o=!0),h.leaf&&(a=r(t,h.children,i),a!==-1))return h.children.splice(a,1),u.push(h),this._condense(u),this;o||h.leaf||!l(h,s)?e?(n++,h=e.children[n],o=!1):h=null:(u.push(h),c.push(n),n=0,e=h,h=h.children[0])}return this},toBBox:function(t){return t},compareMinX:o,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){var i=this;return this.data=t,this.walk(function(t){i._nodesUuid[t.id]=t}),this},_all:function(t,i,n){n=n||{};for(var e=[];t;)n[t.height]=n[t.height]||{},n[t.height][t.id]=t,t.leaf?i.push.apply(i,t.children):e.push.apply(e,t.children),t=e.pop();return i},_build:function(t,i,n,e){var r,a=n-i+1,o=this._maxEntries;if(a<=o)return r=this._createNode(t.slice(i,n+1)),this._calcBBox(r,this.toBBox),r;e||(e=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,e-1))),r=this._createNode([]),r.leaf=!1,r.height=e;var h,s,u,c,f=Math.ceil(a/o),l=f*Math.ceil(Math.sqrt(o));for(m(t,i,n,l,this.compareMinX),h=i;h<=n;h+=l)for(u=Math.min(h+l-1,n),m(t,h,u,f,this.compareMinY),s=h;s<=u;s+=f)c=Math.min(s+f-1,u),r.children.push(this._build(t,s,c,e-1));return this._calcBBox(r,this.toBBox),r},_chooseSubtree:function(t,i,n,e){for(var r,a,o,h,u,f,l,d;;){if(e.push(i),i.leaf||e.length-1===n)break;for(l=d=1/0,r=0,a=i.children.length;r<a;r++)o=i.children[r],u=s(o),f=c(t,o)-u,f<d?(d=f,l=u<l?u:l,h=o):f===d&&u<l&&(l=u,h=o);i=h||i.children[0]}return i},_insert:function(t,i,n){var e=this.toBBox,r=n?t:e(t),o=[],h=this._chooseSubtree(r,this.data,i,o);for(h.children.push(t),a(h,r);i>=0&&o[i].children.length>this._maxEntries;)this._split(o,i),i--;this._adjustParentBBoxes(r,o,i)},_split:function(t,i){var n=t[i],e=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,e);var a=this._chooseSplitIndex(n,r,e),o=this._createNode(n.children.splice(a,n.children.length-a));o.height=n.height,o.leaf=n.leaf,this._calcBBox(n,this.toBBox),this._calcBBox(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,i){this.data=this._createNode([t,i]),this.data.height=t.height+1,this.data.leaf=!1,this._calcBBox(this.data,this.toBBox)},_chooseSplitIndex:function(t,i,n){var e,r,a,o,h,u,c,l;for(u=c=1/0,e=i;e<=n-i;e++)r=this._distBBox(t,0,e,this.toBBox),a=this._distBBox(t,e,n,this.toBBox),o=f(r,a),h=s(r)+s(a),o<u?(u=o,l=e,c=h<c?h:c):o===u&&h<c&&(c=h,l=e);return l},_chooseSplitAxis:function(t,i,n){var e=t.leaf?this.compareMinX:o,r=t.leaf?this.compareMinY:h,a=this._allDistMargin(t,i,n,e),s=this._allDistMargin(t,i,n,r);a<s&&t.children.sort(e)},_allDistMargin:function(t,i,n,e){t.children.sort(e);var r,o,h=this.toBBox,s=this._distBBox(t,0,i,h),c=this._distBBox(t,n-i,n,h),f=u(s)+u(c);for(r=i;r<n-i;r++)o=t.children[r],a(s,t.leaf?h(o):o),f+=u(s);for(r=n-i-1;r>=i;r--)o=t.children[r],a(c,t.leaf?h(o):o),f+=u(c);return f},_adjustParentBBoxes:function(t,i,n){for(var e=n;e>=0;e--)a(i[e],t)},_condense:function(t){for(var i,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(i=t[n-1].children,i.splice(i.indexOf(t[n]),1)):this.clear():this._calcBBox(t[n],this.toBBox)},_initFormat:function(t){var i=["return a"," - b",";"];this.compareMinX=new Function("a","b",i.join(t[0])),this.compareMinY=new Function("a","b",i.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")},_calcBBox:function(t,i){this._distBBox(t,0,t.children.length,i,t)},_distBBox:function(t,i,n,e,r){r||(r=this._createNode(null)),r.minX=1/0,r.minY=1/0,r.maxX=-(1/0),r.maxY=-(1/0);for(var o,h=i;h<n;h++)o=t.children[h],a(r,t.leaf?e(o):o);return r},_createNode:function(t){var i=p.v4(),n={children:t,height:1,id:i,leaf:!0,minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)};return this._nodesUuid[i]=n,n}}},{quickselect:2,uuid:4}],2:[function(t,i,n){"use strict";function e(t,i,n,o,h){for(n=n||0,o=o||t.length-1,h=h||a;o>n;){if(o-n>600){var s=o-n+1,u=i-n+1,c=Math.log(s),f=.5*Math.exp(2*c/3),l=.5*Math.sqrt(c*f*(s-f)/s)*(u-s/2<0?-1:1),d=Math.max(n,Math.floor(i-u*f/s+l)),m=Math.min(o,Math.floor(i+(s-u)*f/s+l));e(t,i,d,m,h)}var x=t[i],p=n,v=o;for(r(t,n,i),h(t[o],x)>0&&r(t,n,o);p<v;){for(r(t,p,v),p++,v--;h(t[p],x)<0;)p++;for(;h(t[v],x)>0;)v--}0===h(t[n],x)?r(t,n,v):(v++,r(t,v,o)),v<=i&&(n=v+1),i<=v&&(o=v-1)}}function r(t,i,n){var e=t[i];t[i]=t[n],t[n]=e}function a(t,i){return t<i?-1:t>i?1:0}i.exports=e},{}],3:[function(t,i,n){(function(t){var n,e=t.crypto||t.msCrypto;if(e&&e.getRandomValues){var r=new Uint8Array(16);n=function(){return e.getRandomValues(r),r}}if(!n){var a=new Array(16);n=function(){for(var t,i=0;i<16;i++)0===(3&i)&&(t=4294967296*Math.random()),a[i]=t>>>((3&i)<<3)&255;return a}}i.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(t,i,n){function e(t,i,n){var e=i&&n||0,r=0;for(i=i||[],t.toLowerCase().replace(/[0-9a-f]{2}/g,function(t){r<16&&(i[e+r++]=u[t])});r<16;)i[e+r++]=0;return i}function r(t,i){var n=i||0,e=s;return e[t[n++]]+e[t[n++]]+e[t[n++]]+e[t[n++]]+"-"+e[t[n++]]+e[t[n++]]+"-"+e[t[n++]]+e[t[n++]]+"-"+e[t[n++]]+e[t[n++]]+"-"+e[t[n++]]+e[t[n++]]+e[t[n++]]+e[t[n++]]+e[t[n++]]+e[t[n++]]}function a(t,i,n){var e=i&&n||0,a=i||[];t=t||{};var o=void 0!==t.clockseq?t.clockseq:d,h=void 0!==t.msecs?t.msecs:(new Date).getTime(),s=void 0!==t.nsecs?t.nsecs:x+1,u=h-m+(s-x)/1e4;if(u<0&&void 0===t.clockseq&&(o=o+1&16383),(u<0||h>m)&&void 0===t.nsecs&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=h,x=s,d=o,h+=122192928e5;var c=(1e4*(268435455&h)+s)%4294967296;a[e++]=c>>>24&255,a[e++]=c>>>16&255,a[e++]=c>>>8&255,a[e++]=255&c;var f=h/4294967296*1e4&268435455;a[e++]=f>>>8&255,a[e++]=255&f,a[e++]=f>>>24&15|16,a[e++]=f>>>16&255,a[e++]=o>>>8|128,a[e++]=255&o;for(var p=t.node||l,v=0;v<6;v++)a[e+v]=p[v];return i?i:r(a)}function o(t,i,n){var e=i&&n||0;"string"==typeof t&&(i="binary"==t?new Array(16):null,t=null),t=t||{};var a=t.random||(t.rng||h)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,i)for(var o=0;o<16;o++)i[e+o]=a[o];return i||r(a)}for(var h=t("./rng"),s=[],u={},c=0;c<256;c++)s[c]=(c+256).toString(16).substr(1),u[s[c]]=c;var f=h(),l=[1|f[0],f[1],f[2],f[3],f[4],f[5]],d=16383&(f[6]<<8|f[7]),m=0,x=0,p=o;p.v1=a,p.v4=o,p.parse=e,p.unparse=r,i.exports=p},{"./rng":3}]},{},[1])(1)});
